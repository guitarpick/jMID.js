var jMID=function(d){var o=function(a){for(var b=a.split(",").map(function(a){return a.trim()}),a=[],c=0,e=b.length;c<e;c++)a.push(b[c].split(" "));b=[];c=0;for(e=this._results.tracks.length;c<e;c++){var m=this._results.tracks[c];b.push(new d.Track);for(var i=0,g=m.getEvents().length;i<g;i++)for(var k=m.getEvents(i),j=!1,p=0,o=a.length;p<o;p++){for(var q=a[p],n=0,r=q.length;n<r;n++){var l;a:{l=q[n];for(var h=[":",">",">=","<","<="],f=h.length-1;0<=f;f--)if(-1!==l.search(h[f])){l=h[f];break a}l=void 0}f=
q[n].split(l);h=f[0];f=f[1];switch(l){case ":":j=k[h]==f;break;case ">":j=k[h]>f;break;case ">=":j=k[h]>=f;break;case "<":j=k[h]<f;break;case "<=":j=k[h]<=f}if(!j)break}j&&b[c].pushEvent(k)}}return{tracks:b}},g=function(a,b){this._results=b?b:{tracks:a.tracks.slice(0)};this._file=a};g.prototype={filter:function(a){a=o.call(this,a);return new g(this._file,a)},not:function(a){for(var a=o.call(this,a),b=this._results,c=[],e=0,m=b.tracks.length;e<m;e++){var i=new d.Track(b.tracks[e].cloneEvents());i.removeEvents.apply(i,
a.tracks[e].getEvents());c.push(i)}return new g(this._file,{tracks:c})},toArray:function(){for(var a=[],b=0,c=this._results.tracks.length;b<c;b++)a=a.concat(this._results.tracks[b].events);return a},increment:function(a,b){d.Util.forAllEvents(this._results.tracks,function(c){a in c&&(c[a]+=b)});return this},set:function(a,b){d.Util.forAllEvents(this._results.tracks,function(c){a in c&&(c[a]=b)});return this},get:function(a,b){return this._results.tracks[a].events[b]},eq:function(a,b){return new g(this._file,
{tracks:[new d.Track([this.get.apply(this,arguments)])]})},encodeEvents:function(a){var b=[];d.Util.forAllEvents(this._results.tracks,function(c,e,g){b[g]||(b[g]=[]);b[g].push(!a?d.Util.bytesToString(c.encode()):c.encode())});return b},encodeTracks:function(a){var b=[];d.Util.forEachTrack(this._results.tracks,function(c,e){b[e]||(b[e]=[]);b[e].push(!a?c.encode():d.Util.stringToBytes(c.encode()))});return b},apply:function(){for(var a=0,b=this._results.tracks.length;a<b;a++)this._file.tracks[a]=new d.Track(this._results.tracks[a].cloneEvents());
return new g(this._file)}};d.Query=function(a){if(!a&&!a instanceof d.File)throw Error("jMID.File is needed for querying");return new g(a)};return d}(jMID||{});
