/**
 * jMID.Track.min.js v0.1
 *
 * A javascript library for reading, manipulating, and writing MIDI files
 * @author Steven Sojka - Thursday, January 31, 2013
 *
 * MIT Licensed
 */
var jMID=function(f){var g=function(a){for(var b,c=Array.prototype.slice.call(arguments,1),d=c.length,e;d&&this[a].length;)for(b=c[--d];-1!==(e=this[a].indexOf(b));)this[a].splice(e,1);return this};f.Track=function(a){this.events=[];this.notes=[];for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);this.processNotes()};f.Track.prototype={pushEvent:function(a){this.events.push(a);return this},pushNote:function(a){this.notes.push(a);return this},getEvents:function(a){return"undefined"!==typeof a?0<=a&&
a<this.events.length?this.events[a]:null:this.events},getNotes:function(a){return"undefined"!==typeof a?0<=a&&a<this.notes.length?this.notes[a]:null:this.notes},removeEvents:function(){return g.apply(this,["events"].concat(Array.prototype.slice.call(arguments)))},removeNotes:function(){return g.apply(this,["notes"].concat(Array.prototype.slice.call(arguments)))},cloneEvents:function(){return this.events.slice(0)},cloneNotes:function(){return this.notes.slice(0)},encode:function(){for(var a=[],b=0,
c=0,d=this.events.length;c<d;c++){var e=this.getEvents(c).encode(),b=b+e.length;Array.prototype.push.apply(a,e)}b=f.Util.stringToBytes(b.toString(16),4);return f.Util.bytesToString([77,84,114,107].concat(b,a))},adjustEventTime:function(a,b){var a=f.Util.isNumber(a)?this.events[a]:a,c=this.events.indexOf(a),d=this.events[c+1];Math.round(b/this.timing.MSPT);var e;a.time+=b;this.events.splice(c,1);for(var c=0,h=this.events.length;c<h;c++)if(!(a.time>=this.events[c].time)){this.events.splice(c,0,a);e=
c;break}this.calculateDelta(d,a,this.events[e+1])},calculateDelta:function(){for(var a=Array.prototype.slice.call(arguments),b=0,c=a.length;b<c;b++){var d=a[b],e=this.events.indexOf(d),e=this.events[e-1];d.deltaTime=e?Math.round((d.time-e.time)/this.timing.MSPT):Math.round(d.time/this.timing.MSPT)}},switchEvents:function(a,b){var c=this.events.indexOf(a),d=this.events.indexOf(b);this.events.splice(d,1,a);this.events.splice(c,1,b)},processNotes:function(){var a={};this.notes=[];for(var b=0,c=this.events.length;b<
c;b++){var d=this.events[b];"noteOn"===d.subtype?a[d.noteNumber]=d:"noteOff"===d.subtype&&d.noteNumber in a&&(this.notes.push(new f.Note(a[d.noteNumber],d,this)),delete a[d.noteNumber])}},processChannelEventTimes:function(){for(var a=this.timing.MSPT,b=0,c=0,d=this.events.length;c<d;c++){var e=this.events[c],f=e.deltaTime*a;e.set("time",b+f);b+=f}}};f.Emitter&&f.Emitter.register(f.Track);return f}(jMID||{});
