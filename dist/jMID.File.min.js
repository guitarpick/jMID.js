/**
 * jMID.File.min.js v0.2.1
 *
 * A javascript library for reading, manipulating, writing, and timing MIDI files
 * @author Steven Sojka - Tuesday, March 19, 2013
 *
 * MIT Licensed
 */
var jMID=function(c){c.File=function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);this.timeSignature={beatsPerBar:4,beatValue:4};this.timing={MicroSPB:5E5,MSPQN:500,MSPT:500/960};this.header||(this.header={format:0,trackCount:1,ticksPerBeat:960});if(this.tracks){this.processMetaEvents();for(a=this.tracks.length-1;0<=a;a--)this.tracks[a].timing=this.timing;this.processChannelEventTimes();this.processNotes()}else this.tracks=[new c.Track],this.header.trackCount=1,this.calculateBPM()};c.File.prototype=
{processMetaEvents:function(){for(var a=c.Query(this).filter("type:meta").not("subtype:endOfTrack, subtype:trackName").toArray(),b=0,d=a.length;b<d;b++)switch(a[b].subtype){case "timeSignature":this.timeSignature.beatsPerBar=a[b].numerator;this.timeSignature.beatValue=a[b].denominator;break;case "setTempo":this.timing.MicroSPB=a[b].microsecondsPerBeat}this.calculateBPM();this.timing.MSPQN=this.timing.MicroSPB/1E3;this.timing.MSPT=this.timing.MSPQN/this.header.ticksPerBeat},processChannelEventTimes:function(){for(var a=
0,b=this.tracks.length;a<b;a++)this.tracks[a].processChannelEventTimes();this.duration=Math.max.apply(Math,this.tracks.map(function(a){return a.duration}))},processNotes:function(){for(var a=0,b=this.tracks.length;a<b;a++)this.tracks[a].processNotes()},calculateBPM:function(){this.timing.BPM=6E7/this.timing.MicroSPB*(this.timeSignature.beatValue/4)},createTrack:function(a){this.tracks.push(new c.Track(a))},removeTrack:function(a){this.tracks.splice(a,1)},setTempo:function(a){this.timing.BPM=a;this.timing.MSPQN=
6E4*(1/a);this.timing.MicroSPB=1E3*this.timing.MSPQN;this.timing.MSPT=this.timing.MSPQN/this.header.ticksPerBeat;this.processChannelEventTimes()},getTrack:function(a){return this.tracks[a]},getHeader:function(){return this.header},encode:function(){return(new c.Encoder).encode(this)},base64Encode:function(){return btoa(this.encode())}};c.Emitter&&c.Emitter.register(c.File);return c}(jMID||{});
